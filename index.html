<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<title>Meus Vídeos no GitHub Pages</title>
<style>
  body { font-family: Arial; background: #181818; color: white; margin: 0; padding: 0; }
  h1 { text-align: center; background: #202020; padding: 15px; margin: 0; }
  .controls { text-align: center; padding: 10px; background: #202020; }
  input, select { padding: 5px; margin: 5px; border-radius: 5px; border: none; }
  .container { display: flex; flex-wrap: wrap; justify-content: center; padding: 10px; }
  .video { background: #202020; margin: 10px; border-radius: 8px; max-width: 360px; overflow: hidden; cursor: pointer; }
  .video img { width: 100%; display: block; border-radius: 8px; }
  .video p { text-align: center; padding: 5px; margin: 0; font-size: 14px; color: #ccc; }
  /* Tela cheia personalizada */
  #fullscreenContainer {
    display: none;
    position: fixed;
    inset: 0;
    background: black;
    z-index: 9999;
  }
  #fullscreenContainer iframe,
  #fullscreenContainer video {
    width: 100%;
    height: 100%;
    border: none;
    background: black;
  }
</style>
</head>
<body>
  <h1>Meus Vídeos no GitHub Pages</h1>

  <div class="controls">
    <input type="text" id="search" placeholder="Buscar vídeo..." />
    <select id="category">
      <option value="all">Todas categorias</option>
      <option value="youtube">YouTube</option>
      <option value="local">Locais</option>
    </select>
  </div>

  <div class="container" id="videoContainer"></div>

  <!-- Contêiner para fullscreen -->
  <div id="fullscreenContainer"></div>

  <script>
    const linkTXT = "https://raw.githubusercontent.com/DougMorDias/site_videos/main/videos.txt"; 
    let videosGlobal = [];

    function extrairID(link) {
      if (link.includes("youtube.com")) {
        try {
          const url = new URL(link);
          return url.searchParams.get("v") || "";
        } catch {
          return "";
        }
      } else if (link.includes("youtu.be")) {
        return link.split("/").pop().split("?")[0];
      }
      return "";
    }

    function abrirFullscreenPersonalizado(tipo, link) {
      const container = document.getElementById("fullscreenContainer");
      container.innerHTML = ""; // limpar antes

      if (tipo === "youtube") {
        const videoId = extrairID(link);
        const iframe = document.createElement("iframe");
        iframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1`;
        iframe.allowFullscreen = true;
        container.appendChild(iframe);
      } else {
        const videoTag = document.createElement("video");
        videoTag.src = link;
        videoTag.controls = true;
        videoTag.autoplay = true;
        container.appendChild(videoTag);
      }

      container.style.display = "block";

      if (container.requestFullscreen) {
        container.requestFullscreen();
      } else if (container.webkitRequestFullscreen) {
        container.webkitRequestFullscreen();
      } else if (container.msRequestFullscreen) {
        container.msRequestFullscreen();
      }

      // Sair do fullscreen fecha o contêiner
      document.addEventListener("fullscreenchange", () => {
        if (!document.fullscreenElement) {
          container.style.display = "none";
          container.innerHTML = "";
        }
      });
    }

    function renderVideos(filtroTexto = "", filtroCategoria = "all") {
      const container = document.getElementById("videoContainer");
      container.innerHTML = "";

      const filtrados = videosGlobal.filter(
        (v) =>
          (filtroCategoria === "all" || v.tipo === filtroCategoria) &&
          v.link.toLowerCase().includes(filtroTexto.toLowerCase())
      );

      if (filtrados.length === 0) {
        container.innerHTML =
          "<p style='text-align: center;'>Nenhum vídeo encontrado.</p>";
        return;
      }

      filtrados.forEach((v) => {
        const videoDiv = document.createElement("div");
        videoDiv.className = "video";

        if (v.tipo === "youtube") {
          const videoId = extrairID(v.link);
          const thumbUrl = `https://img.youtube.com/vi/${videoId}/hqdefault.jpg`;
          videoDiv.innerHTML = `<img src="${thumbUrl}" alt="Miniatura do vídeo"><p>YouTube</p>`;
          videoDiv.addEventListener("click", () => abrirFullscreenPersonalizado(v.tipo, v.link));
        } else {
          // Usar um ícone ou imagem padrão para vídeos locais
          videoDiv.innerHTML = `<img src="https://via.placeholder.com/360x200/000000/FFFFFF?text=Vídeo+Local" alt="Miniatura do vídeo"><p>Local</p>`;
          videoDiv.addEventListener("click", () => abrirFullscreenPersonalizado(v.tipo, v.link));
        }

        container.appendChild(videoDiv);
      });
    }

    async function inicializar() {
      try {
        const resp = await fetch(linkTXT);
        const texto = await resp.text();
        const links = texto.split("\n").map((l) => l.trim()).filter((l) => l);
        videosGlobal = links.map((link) => ({
          link,
          tipo:
            link.includes("youtube.com") || link.includes("youtu.be")
              ? "youtube"
              : "local",
        }));
        renderVideos();
      } catch (error) {
        console.error("Erro ao carregar vídeos:", error);
        document.getElementById("videoContainer").innerHTML =
          "<p style='color: red; text-align: center;'>Erro ao carregar vídeos. Verifique o link e permissões do arquivo .txt no GitHub.</p>";
      }
    }

    document.getElementById("search").addEventListener("input", () => {
      renderVideos(
        document.getElementById("search").value,
        document.getElementById("category").value
      );
    });

    document.getElementById("category").addEventListener("change", () => {
      renderVideos(
        document.getElementById("search").value,
        document.getElementById("category").value
      );
    });

    inicializar();
  </script>
</body>
</html>