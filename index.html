<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<title>Meus Vídeos no GitHub Pages</title>
<style>
  body { font-family: Arial; background: #181818; color: white; margin: 0; padding: 0; }
  h1 { text-align: center; background: #202020; padding: 15px; margin: 0; }
  .controls { text-align: center; padding: 10px; background: #202020; }
  input, select { padding: 5px; margin: 5px; border-radius: 5px; border: none; }
  .container { display: flex; flex-wrap: wrap; justify-content: center; padding: 10px; }
  .video { background: #202020; margin: 10px; padding: 5px; border-radius: 8px; max-width: 360px; }
  iframe, video { width: 100%; height: 200px; border: none; border-radius: 8px; background: black; }
</style>
</head>
<body>
  <h1>Meus Vídeos no GitHub Pages</h1>

  <div class="controls">
    <input type="text" id="search" placeholder="Buscar vídeo..." />
    <select id="category">
      <option value="all">Todas categorias</option>
      <option value="youtube">YouTube</option>
      <option value="local">Locais</option>
    </select>
  </div>

  <div class="container" id="videoContainer"></div>

  <script>
    const linkTXT = "https://raw.githubusercontent.com/DougMorDias/site_videos/main/videos.txt"; // Sbstitua seuusuario e repositorio

    function extrairID(link) {
      let videoId = "";
      if (link.includes("youtube.com")) {
        try {
          const url = new URL(link);
          videoId = url.searchParams.get("v") || "";
        } catch {
          videoId = "";
        }
      } else if (link.includes("youtu.be")) {
        videoId = link.split("/").pop().split("?")[0];
      }
      return videoId;
    }

    async function carregarVideos() {
      try {
        const resp = await fetch(linkTXT);
        const texto = await resp.text();
        const links = texto.split("\n").map((l) => l.trim()).filter((l) => l);

        const videos = links.map((link) => ({
          link,
          tipo:
            link.includes("youtube.com") || link.includes("youtu.be")
              ? "youtube"
              : "local",
        }));

        renderVideos(videos);
      } catch (error) {
        console.error("Erro ao carregar vídeos:", error);
        document.getElementById("videoContainer").innerHTML =
          "<p style='color: red; text-align: center;'>Erro ao carregar vídeos. Verifique o link e permissões do arquivo .txt no GitHub.</p>";
      }
    }

    function renderVideos(videos, filtroTexto = "", filtroCategoria = "all") {
      const container = document.getElementById("videoContainer");
      container.innerHTML = "";

      const filtrados = videos.filter(
        (v) =>
          (filtroCategoria === "all" || v.tipo === filtroCategoria) &&
          v.link.toLowerCase().includes(filtroTexto.toLowerCase())
      );

      if (filtrados.length === 0) {
        container.innerHTML =
          "<p style='text-align: center;'>Nenhum vídeo encontrado.</p>";
        return;
      }

      filtrados.forEach((v) => {
        const videoDiv = document.createElement("div");
        videoDiv.className = "video";

        if (v.tipo === "youtube") {
          const videoId = extrairID(v.link);
          if (videoId) {
            videoDiv.innerHTML = `<iframe src="https://www.youtube.com/embed/${videoId}" allowfullscreen></iframe>`;
          } else {
            videoDiv.innerHTML =
              "<p style='color: red;'>Link de YouTube inválido: " +
              v.link +
              "</p>";
          }
        } else {
          videoDiv.innerHTML = `<video controls><source src="${v.link}" type="video/mp4"></video>`;
        }

        container.appendChild(videoDiv);
      });
    }

    document.getElementById("search").addEventListener("input", (e) => {
      carregarVideos().then(() =>
        renderVideos(
          videosGlobal,
          e.target.value,
          document.getElementById("category").value
        )
      );
    });

    document.getElementById("category").addEventListener("change", (e) => {
      carregarVideos().then(() =>
        renderVideos(
          videosGlobal,
          document.getElementById("search").value,
          e.target.value
        )
      );
    });

    let videosGlobal = [];

    async function inicializar() {
      try {
        const resp = await fetch(linkTXT);
        const texto = await resp.text();
        const links = texto.split("\n").map((l) => l.trim()).filter((l) => l);
        videosGlobal = links.map((link) => ({
          link,
          tipo:
            link.includes("youtube.com") || link.includes("youtu.be")
              ? "youtube"
              : "local",
        }));

        renderVideos(videosGlobal);
      } catch (error) {
        console.error("Erro ao carregar vídeos:", error);
        document.getElementById("videoContainer").innerHTML =
          "<p style='color: red; text-align: center;'>Erro ao carregar vídeos. Verifique o link e permissões do arquivo .txt no GitHub.</p>";
      }
    }

    inicializar();
  </script>
</body>
</html>